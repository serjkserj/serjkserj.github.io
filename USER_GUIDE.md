# Руководство пользователя по работе с диаграммами и изображениями

## Введение

Данное руководство описывает процесс работы с диаграммами Mermaid и изображениями в проекте документации на базе Docusaurus. Руководство охватывает исправление синтаксиса диаграмм, извлечение и обработку изображений из .docx файлов, а также преобразование документов в формат Markdown.

## Раздел 1: Работа с Mermaid диаграммами

### Описание проблемы с первой диаграммой

При анализе проекта была обнаружена проблема с синтаксисом первой Mermaid диаграммы в файле `docs/atr_fb_zadanie.md`. Диаграмма содержала некорректный синтаксис, что приводило к ошибкам при отображении в Docusaurus.

### Метод исправления синтаксиса диаграмм

Для исправления синтаксиса диаграмм был разработан следующий подход:

1. **Проверка синтаксиса**: Использование скрипта `check_mermaid_working.js` для проверки корректности синтаксиса диаграмм
2. **Автоматическое исправление**: Создание скрипта `check_mermaid_errors.js` для выявления и исправления ошибок в синтаксисе
3. **Ручная корректировка**: При необходимости - ручное исправление синтаксиса диаграмм

### Рекомендации по созданию корректных диаграмм

1. **Используйте правильный синтаксис**:
   ```mermaid
   graph TD
       A[Начало] --> B[Обработка]
       B --> C[Результат]
   ```

2. **Проверяйте синтаксис перед добавлением**:
   - Используйте онлайн-валидаторы Mermaid
   - Тестируйте диаграммы в изоляции

3. **Избегайте распространенных ошибок**:
   - Неправильные отступы
   - Отсутствие закрывающих скобок
   - Некорректные названия узлов

## Раздел 2: Обработка изображений из .docx файлов

### Описание проблемы с изображениями

Исходные .docx файлы содержали изображения с неструктурированными именами и путями хранения. Это создавало проблемы при конвертации в формат Markdown и отображении в Docusaurus.

### Разработанная система именования изображений

Была разработана система именования изображений по следующему шаблону:
```
[документ_сокращенный]_[порядковый_номер].[расширение]
```

Примеры:
- `clashes_manager_1.png`
- `navisworks_2.png`
- `model_export_3.png`

### Структура папок для хранения изображений

Изображения организованы в следующую структуру:
```
static/
├── img/
│   └── docs/
│       └── images/
│           ├── clashes_manager/
│           ├── navisworks/
│           ├── model_export/
│           ├── svod_codes/
│           └── clashes_helper/
└── docs/
    └── images/ (дубликат структуры)
```

### Описание созданных скриптов для обработки изображений

1. **extract_images.py** - извлекает изображения из .docx файлов
   - Автоматически создает папки для каждого документа
   - Сохраняет изображения в исходном формате

2. **rename_images.py** - переименовывает изображения согласно системе именования
   - Применяет шаблон `[документ_сокращенный]_[порядковый_номер].[расширение]`
   - Сохраняет порядок следования изображений в документах

3. **update_markdown_paths.py** - обновляет пути к изображениям в .md файлах
   - Автоматически заменяет старые пути на новые
   - Работает с относительными путями

4. **fix_markdown_image_names.py** - исправляет имена изображений в .md файлах
   - Корректирует формат ссылок на изображения
   - Унифицирует синтаксис Markdown

5. **process_docx_images.py** - объединенный скрипт для выполнения всех операций
   - Выполняет полный цикл обработки изображений
   - Упрощает работу с новыми документами

## Раздел 3: Пошаговая инструкция для преобразования .docx в .md

### Подготовка окружения

1. Убедитесь, что установлен Python 3.x
2. Установите необходимые зависимости:
   ```bash
   pip install python-docx
   pip install markdown
   ```
3. Скопируйте все .docx файлы в папку `docs/docx/`

### Извлечение изображений из .docx файлов

1. Запустите скрипт извлечения изображений:
   ```bash
   python extract_images.py
   ```
2. Скрипт автоматически создаст папки и извлечет все изображения
3. Проверьте, что все изображения извлечены корректно

### Обработка и переименование изображений

1. Запустите скрипт переименования изображений:
   ```bash
   python rename_images.py
   ```
2. Скрипт переименует все изображения согласно системе именования
3. Убедитесь, что все изображения имеют корректные имена

### Обновление путей к изображениям в .md файлах

1. Запустите скрипт обновления путей:
   ```bash
   python update_markdown_paths.py
   ```
2. Скрипт автоматически обновит все пути к изображениям в .md файлах
3. При необходимости запустите скрипт исправления имен:
   ```bash
   python fix_markdown_image_names.py
   ```

### Проверка корректности отображения

1. Скопируйте все изображения в папку `static/img/docs/images/`
2. Запустите Docusaurus для проверки отображения:
   ```bash
   npm run start
   ```
3. Проверьте, что все изображения отображаются корректно
4. Убедитесь, что Docusaurus компилируется без ошибок

### Автоматизированный процесс

Для полного автоматизированного процесса используйте объединенный скрипт:
```bash
python process_docx_images.py
```

Этот скрипт выполнит все операции в правильном порядке:
1. Извлечет изображения из .docx файлов
2. Переименует изображения согласно системе именования
3. Обновит пути к изображениям в .md файлах
4. Исправит имена изображений в Markdown

## Заключение: рекомендации по дальнейшей поддержке документации

### Регулярное обслуживание

1. **При добавлении новых .docx файлов**:
   - Используйте скрипт `process_docx_images.py` для автоматической обработки
   - Проверяйте корректность отображения после обработки

2. **Проверка актуальности изображений**:
   - Регулярно проверяйте, что все изображения в документах актуальны
   - Обновляйте изображения при необходимости

3. **Обновление документации**:
   - Сохраняйте актуальность путей к изображениям
   - Обновляйте описания и подписи к изображениям

### Дальнейшие улучшения

1. **Добавление описаний к изображениям**:
   - Рассмотрите возможность включения описаний в систему именования
   - Добавьте альтернативные тексты для улучшения доступности

2. **Оптимизация изображений**:
   - Сжимайте изображения для улучшения производительности
   - Используйте современные форматы (WebP) где возможно

3. **Автоматизация тестирования**:
   - Разработайте скрипты для автоматической проверки корректности отображения
   - Добавьте тесты для проверки целостности ссылок на изображения

### Важные замечания

- Всегда делайте резервные копии документов перед обработкой
- Проверяйте корректность отображения после каждой операции
- Сохраняйте резервные копии скриптов для возможности отката изменений
- Документируйте все изменения в системе контроля версий

Следуя этому руководству, вы сможете эффективно работать с диаграммами и изображениями в проекте документации, обеспечивая качество и актуальность контента.